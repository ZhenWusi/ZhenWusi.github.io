<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- 基本 meta 标签 -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <!-- SEO meta 标签 -->
  <title>力扣 88：合并两个有序数组 | 九九的个人博客 | JiuJiu&#39;s Blog</title>
  <meta name="description" content="一个热爱技术的开发者的个人博客，分享编程、技术和生活感悟。">
  <meta name="keywords" content="力扣,数组">
  <meta name="author" content="ZhenWusi">

  <!-- Open Graph 社交分享 -->
  <meta property="og:title" content="力扣 88：合并两个有序数组">
  <meta property="og:description" content="一个热爱技术的开发者的个人博客，分享编程、技术和生活感悟。">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://zhenwusi.github.io/2026/02/23/%E5%8A%9B%E6%89%A3/index.html">
  <meta property="og:image" content="/img/%E5%A4%B4%E5%83%8F.jpg">
  <meta property="og:image:alt" content="ZhenWusi的头像">

  <!-- 图标 -->
  <link rel="icon" href="/img/头像.jpg" type="image/jpeg">
  <link rel="apple-touch-icon" href="/img/头像.jpg">
  <link rel="shortcut icon" href="/img/头像.jpg">

  <!-- Google Fonts - Noto Sans SC -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome 图标 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script defer src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>

  <!-- 主样式表 -->
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="九九的个人博客 | JiuJiu's Blog" type="application/atom+xml">
</head>
<body>
  <!-- 全局加载动画 -->
  <div id="loading-mask">
    <div class="spinner"></div>
  </div>

  <!-- 顶部导航栏 -->
  

<!-- 顶部导航栏 -->
<header class="site-header" id="site-header">
  <div class="header-inner">
    <!-- 桌面端导航菜单 -->
    <nav class="site-nav" id="site-nav">
      
        <a href="/" class="nav-link">
          
            <iconify-icon icon="mingcute:home-2-fill"></iconify-icon>
          
          <span class="nav-text">首页</span>
        </a>
      
        <a href="/archives" class="nav-link">
          
            <iconify-icon icon="mingcute:inbox-fill"></iconify-icon>
          
          <span class="nav-text">文章</span>
        </a>
      
        <a href="/about" class="nav-link">
          
            <iconify-icon icon="mingcute:user-info-fill"></iconify-icon>
          
          <span class="nav-text">关于</span>
        </a>
      
        <a href="/categories" class="nav-link">
          
            <iconify-icon icon="mingcute:classify-2-fill"></iconify-icon>
          
          <span class="nav-text">分类</span>
        </a>
      
        <a href="/tags" class="nav-link">
          
            <iconify-icon icon="mingcute:tag-fill"></iconify-icon>
          
          <span class="nav-text">标签</span>
        </a>
      
    </nav>

    <!-- 功能按钮区域 -->
    <div class="header-actions">
      <!-- 搜索按钮 -->
      <button class="action-btn" id="search-toggle" title="搜索">
        <i class="fas fa-search"></i>
      </button>
      <!-- 移动端菜单按钮 -->
      <button class="action-btn mobile-menu-btn" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </div>

  <!-- 搜索弹窗 -->
  <div class="search-overlay" id="search-overlay">
    <div class="search-box">
      <input type="text" id="search-input" placeholder="搜索文章..." autocomplete="off">
      <button id="search-close"><i class="fas fa-times"></i></button>
    </div>
    <div class="search-results" id="search-results"></div>
  </div>
</header>

<!-- 移动端侧滑菜单 -->
<div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>
<aside class="mobile-menu" id="mobile-menu">
  <div class="mobile-menu-header">
    
      <img src="/img/头像.jpg" alt="头像" class="mobile-avatar">
    
    <h3>ZhenWusi</h3>
    
      <p>龙出海，虎下山…… | Exploring code &amp; AI</p>
    
  </div>
  <nav class="mobile-nav">
    
      <a href="/" class="mobile-nav-link">
        
          <iconify-icon icon="mingcute:home-2-fill"></iconify-icon>
        
        <span class="nav-text">首页</span>
      </a>
    
      <a href="/archives" class="mobile-nav-link">
        
          <iconify-icon icon="mingcute:inbox-fill"></iconify-icon>
        
        <span class="nav-text">文章</span>
      </a>
    
      <a href="/about" class="mobile-nav-link">
        
          <iconify-icon icon="mingcute:user-info-fill"></iconify-icon>
        
        <span class="nav-text">关于</span>
      </a>
    
      <a href="/categories" class="mobile-nav-link">
        
          <iconify-icon icon="mingcute:classify-2-fill"></iconify-icon>
        
        <span class="nav-text">分类</span>
      </a>
    
      <a href="/tags" class="mobile-nav-link">
        
          <iconify-icon icon="mingcute:tag-fill"></iconify-icon>
        
        <span class="nav-text">标签</span>
      </a>
    
  </nav>
</aside>


  <!-- 页面主内容 -->
  <main class="main-content">
    <!-- 文章详情页布局 -->



<!-- 文章顶部横幅 -->
<section class="post-banner" style="background-image: url('/img/background/')">
  <div class="hero-overlay"></div>
  <div class="post-banner-content">
    <!-- 分类 -->
    
      <div class="post-banner-cats">
        
          <a href="/categories/%E7%AE%97%E6%B3%95/"><i class="fas fa-folder"></i> 算法</a>
        
      </div>
    
    <h1 class="post-banner-title">力扣 88：合并两个有序数组</h1>
    <div class="post-banner-meta">
      <span><i class="far fa-calendar-alt"></i> 2026-02-23</span>
      <span><i class="far fa-clock"></i> 阅读约 357 字</span>
      
        <span><i class="fas fa-tags"></i>
          
          力扣 / 数组
        </span>
      
    </div>
  </div>
</section>

<!-- 文章主体 -->
<div class="reading-progress"><span class="reading-progress__bar"></span></div>
<div class="container post-container">
  <div class="post-layout">
    <!-- 文章内容区域 -->
    <article class="post-content-wrap">
      <!-- 目录（TOC） -->
      
        <div class="post-toc-mobile" id="toc-mobile">
          <details>
            <summary><i class="fas fa-list"></i> 文章目录</summary>
            <div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-text">解题思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">复杂度分析</span></a></li></ol></div>
          </details>
        </div>
      

      <!-- 正文 -->
      <div class="post-body markdown-body" id="post-body">
        <h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定两个按非递减顺序排列的整数数组 <code>nums1</code> 和 <code>nums2</code>，分别有长度 <code>m</code>、<code>n</code>。请将 <code>nums2</code> <strong>原地</strong> 合并到 <code>nums1</code>，使结果仍保持非递减顺序。<code>nums1</code> 的总长度为 <code>m + n</code>，末尾的 <code>n</code> 个位置初始化为 <code>0</code> 作为缓冲区。</p>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p>与其先拼接再整体排序，不如利用“两数组已排序”这一特性，从尾部开始归并：</p>
<ol>
<li>设 <code>p1 = m - 1</code>、<code>p2 = n - 1</code> 分别指向两个数组的最后一个有效元素，<code>tail = m + n - 1</code> 指向合并后数组的尾部；</li>
<li>每轮比较 <code>nums1[p1]</code> 和 <code>nums2[p2]</code>，把较大的放入 <code>nums1[tail]</code>，然后移动对应指针以及 <code>tail</code>；</li>
<li>若 <code>nums2</code> 还有剩余元素（<code>p2 &gt;= 0</code>），继续写入；如果只剩 <code>nums1</code> 元素，无需处理，因为它们已经在正确位置。</li>
</ol>
<p>双指针从后往前填充可以避免移动大量元素，时间复杂度为 $\mathcal{O}(m+n)$，空间复杂度为 $\mathcal{O}(1)$。</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, nums1: <span class="type">List</span>[<span class="built_in">int</span>], m: <span class="built_in">int</span>, nums2: <span class="type">List</span>[<span class="built_in">int</span>], n: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        p1 = m - <span class="number">1</span></span><br><span class="line">        p2 = n - <span class="number">1</span></span><br><span class="line">        tail = m + n - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> p2 &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> p1 &gt;= <span class="number">0</span> <span class="keyword">and</span> nums1[p1] &gt; nums2[p2]:</span><br><span class="line">                nums1[tail] = nums1[p1]</span><br><span class="line">                p1 -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                nums1[tail] = nums2[p2]</span><br><span class="line">                p2 -= <span class="number">1</span></span><br><span class="line">            tail -= <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h2><ul>
<li><strong>时间复杂度</strong>：$\mathcal{O}(m+n)$，每个元素只移动一次；</li>
<li><strong>空间复杂度</strong>：$\mathcal{O}(1)$，原地合并未使用额外数组。</li>
</ul>

      </div>

      <!-- 版权声明 -->
      
        <div class="post-copyright">
          <p><strong><i class="fas fa-copyright"></i> 版权声明</strong></p>
          <p>本文作者：ZhenWusi</p>
          <p>本文链接：<a href="https://zhenwusi.github.io/2026/02/23/%E5%8A%9B%E6%89%A3/">https://zhenwusi.github.io/2026/02/23/%E5%8A%9B%E6%89%A3/</a></p>
          <p>除特别声明外，本站所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</p>
        </div>
      

      <!-- 文章标签 -->
      
        <div class="post-tags">
          
            <a href="/tags/%E5%8A%9B%E6%89%A3/" class="tag-item">
              <i class="fas fa-hashtag"></i>力扣
            </a>
          
            <a href="/tags/%E6%95%B0%E7%BB%84/" class="tag-item">
              <i class="fas fa-hashtag"></i>数组
            </a>
          
        </div>
      

      <!-- 上一篇 / 下一篇导航 -->
      <nav class="post-nav">
        
          <span class="post-nav-item prev disabled"></span>
        
        
          <a href="/2026/02/23/RLHF%20%E7%9A%84%E4%B8%89%E9%98%B6%E6%AE%B5%E6%B5%81%E7%A8%8B/" class="post-nav-item next">
            <span class="post-nav-label">下一篇 <i class="fas fa-chevron-right"></i></span>
            <span class="post-nav-title">RLHF 的三阶段流程</span>
          </a>
        
      </nav>

      <!-- 评论区 -->
      <!-- 评论系统组件 -->


    </article>

    <!-- 侧边栏目录（桌面端） -->
    
      <aside class="post-sidebar" id="post-sidebar">
        <div class="sidebar-toc">
          <h3><i class="fas fa-list"></i> 文章目录</h3>
          <div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-text">解题思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">复杂度分析</span></a></li></ol></div>
        </div>
      </aside>
    
  </div>
</div>

  </main>

  <!-- 页脚 -->
  <!-- 页脚区域 -->
<footer class="site-footer">
  <div class="footer-inner">
    <!-- 页脚信息 -->
    <div class="footer-info">
      <p>
        &copy; 2025 - 2026
        <a href="/">ZhenWusi</a>
      </p>
      <p class="footer-powered">
        
          由 <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> 驱动 |
          主题 <a href="/">NINE</a>
        
      </p>
      
    </div>

    <!-- 页脚社交链接 -->
    <div class="footer-social">
      
      
        
        <a href="https://github.com/ZhenWusi" target="_blank" rel="noopener" title="Github">
          
            <iconify-icon icon="mingcute:github-fill"></iconify-icon>
          
        </a>
      
        
        <a href="https://www.zhihu.com" target="_blank" rel="noopener" title="ZhiHu">
          
            <iconify-icon icon="ri:zhihu-line"></iconify-icon>
          
        </a>
      
        
        <a href="https://twitter.com" target="_blank" rel="noopener" title="Twitter">
          
            <iconify-icon icon="mingcute:social-x-fill"></iconify-icon>
          
        </a>
      
      <a href="/atom.xml" target="_blank" title="RSS 订阅">
        <i class="fas fa-rss"></i>
      </a>
    </div>
  </div>
</footer>


  <!-- 回到顶部按钮 -->
  <button id="back-to-top" title="回到顶部">
    <i class="fas fa-chevron-up"></i>
  </button>

  <!-- 音乐播放器 -->
  
    <!-- 左下角音乐播放器 -->

<div class="mini-music-player" id="mini-music-player">
  <!-- 音乐按钮 -->
  <button class="music-toggle-btn" id="music-toggle-btn" title="音乐播放器">
    <i class="fas fa-music"></i>
  </button>

  <!-- 播放器面板 -->
  <div class="music-panel" id="music-panel">
    <div class="music-content">
      <!-- 自定义播放器 -->
      <div class="custom-player">
        <div class="player-header">
          <div class="song-info">
            <div class="song-title" id="song-title">加载中...</div>
            <div class="song-artist" id="song-artist">请稍候</div>
          </div>
          <div class="player-controls">
            <button class="control-btn" id="prev-btn" title="上一首">
              <i class="fas fa-step-backward"></i>
            </button>
            <button class="control-btn play-btn" id="play-btn" title="播放/暂停">
              <i class="fas fa-play"></i>
            </button>
            <button class="control-btn" id="next-btn" title="下一首">
              <i class="fas fa-step-forward"></i>
            </button>
          </div>
        </div>
        
        <div class="progress-bar">
          <div class="progress-time" id="current-time">0:00</div>
          <div class="progress-track">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
          <div class="progress-time" id="total-time">0:00</div>
        </div>
        
        <div class="playlist-container">
          <div class="playlist-header">
            <span>歌单列表</span>
            <span class="song-count" id="song-count">0首</span>
          </div>
          <div class="playlist-list" id="playlist-list">
            <!-- 歌曲列表将在这里动态生成 -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // 音乐播放器控制
  const musicToggleBtn = document.getElementById('music-toggle-btn');
  const musicPanel = document.getElementById('music-panel');
  const playBtn = document.getElementById('play-btn');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const songTitle = document.getElementById('song-title');
  const songArtist = document.getElementById('song-artist');
  const currentTime = document.getElementById('current-time');
  const totalTime = document.getElementById('total-time');
  const progressFill = document.getElementById('progress-fill');
  const playlistList = document.getElementById('playlist-list');
  const songCount = document.getElementById('song-count');
  
  let songs = [];
  let currentSongIndex = 0;
  let isPlaying = false;
  let audioElement = null;
  
  // 音乐播放器状态管理
  const MUSIC_PLAYER_STATE_KEY = 'musicPlayerState';
  
  // 保存播放器状态
  function savePlayerState() {
    const state = {
      currentSongIndex: currentSongIndex,
      isPlaying: isPlaying,
      currentTime: audioElement ? audioElement.currentTime : 0,
      panelVisible: musicPanel ? musicPanel.classList.contains('active') : false
    };
    localStorage.setItem(MUSIC_PLAYER_STATE_KEY, JSON.stringify(state));
    console.log('保存播放器状态:', state);
  }
  
  // 恢复播放器状态
  function restorePlayerState() {
    try {
      const savedState = localStorage.getItem(MUSIC_PLAYER_STATE_KEY);
      if (savedState) {
        const state = JSON.parse(savedState);
        console.log('恢复播放器状态:', state);
        
        // 恢复歌曲索引
        if (state.currentSongIndex !== undefined) {
          currentSongIndex = state.currentSongIndex;
        }
        
        // 恢复播放状态
        if (state.isPlaying !== undefined) {
          isPlaying = state.isPlaying;
        }
        
        // 恢复面板显示状态
        if (state.panelVisible && musicPanel) {
          musicPanel.classList.add('active');
        }
        
        return true;
      }
    } catch (error) {
      console.error('恢复播放器状态失败:', error);
    }
    return false;
  }
  
  // 定期保存状态
  function setupAutoSave() {
    // 每5秒保存一次状态
    setInterval(savePlayerState, 5000);
    
    // 页面卸载时保存状态
    window.addEventListener('beforeunload', savePlayerState);
    
    // 页面隐藏时保存状态
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        savePlayerState();
      }
    });
  }
  
  // 创建音频元素
  function createAudioElement() {
    audioElement = new Audio();
    audioElement.addEventListener('timeupdate', updateProgress);
    audioElement.addEventListener('ended', playNext);
    audioElement.addEventListener('error', handleAudioError);
  }
  
  // 处理音频错误
  function handleAudioError() {
    console.error('音频播放失败:', audioElement.error);
    // 尝试下一首
    if (currentSongIndex < songs.length - 1) {
      playNext();
    }
  }
  
  // 更新进度
  function updateProgress() {
    if (audioElement && audioElement.duration) {
      const progress = (audioElement.currentTime / audioElement.duration) * 100;
      progressFill.style.width = progress + '%';
      
      currentTime.textContent = formatTime(Math.floor(audioElement.currentTime));
      totalTime.textContent = formatTime(Math.floor(audioElement.duration));
    }
  }
  
  // 播放当前歌曲
  function playCurrentSong() {
    if (songs.length > 0 && songs[currentSongIndex]) {
      const song = songs[currentSongIndex];
      
      if (!audioElement) {
        createAudioElement();
      }
      
      if (song.url) {
        audioElement.src = song.url;
        
        // 恢复播放位置
        const savedState = localStorage.getItem(MUSIC_PLAYER_STATE_KEY);
        if (savedState && isPlaying) {
          const state = JSON.parse(savedState);
          if (state.currentTime > 0) {
            audioElement.currentTime = state.currentTime;
          }
        }
        
        audioElement.play().then(() => {
          isPlaying = true;
          updatePlayButton();
        }).catch(error => {
          console.error('播放失败:', error);
          // 如果播放失败，尝试下一首
          if (currentSongIndex < songs.length - 1) {
            playNext();
          }
        });
      } else {
        console.error('歌曲URL为空:', song);
        // 如果URL为空，尝试下一首
        if (currentSongIndex < songs.length - 1) {
          playNext();
        }
      }
    }
  }
  
  // 播放下一首
  function playNext() {
    if (songs.length > 0) {
      currentSongIndex = (currentSongIndex + 1) % songs.length;
      updateSongInfo();
      updatePlaylist();
      if (isPlaying) {
        playCurrentSong();
      }
    }
  }
  
  // 播放上一首
  function playPrev() {
    if (songs.length > 0) {
      currentSongIndex = (currentSongIndex - 1 + songs.length) % songs.length;
      updateSongInfo();
      updatePlaylist();
      if (isPlaying) {
        playCurrentSong();
      }
    }
  }
  
  // 暂停播放
  function pauseCurrentSong() {
    if (audioElement) {
      audioElement.pause();
    }
    isPlaying = false;
    updatePlayButton();
  }
  
  // 更新播放按钮
  function updatePlayButton() {
    const icon = playBtn.querySelector('i');
    if (isPlaying) {
      icon.className = 'fas fa-pause';
      musicToggleBtn.classList.add('playing');
    } else {
      icon.className = 'fas fa-play';
      musicToggleBtn.classList.remove('playing');
    }
  }
  
  // 更新歌曲信息
  function updateSongInfo() {
    if (songs.length > 0 && songs[currentSongIndex]) {
      const song = songs[currentSongIndex];
      songTitle.textContent = song.title;
      songArtist.textContent = song.artist;
    }
  }
  
  // 更新播放列表
  function updatePlaylist() {
    playlistList.innerHTML = songs.map((song, index) => `
      <div class="playlist-item ${index === currentSongIndex ? 'active' : ''}" data-index="${index}">
        <div class="song-info">
          <div class="song-name">${song.title}</div>
          <div class="song-artist">${song.artist}</div>
        </div>
      </div>
    `).join('');
    
    // 添加点击事件
    document.querySelectorAll('.playlist-item').forEach(item => {
      item.addEventListener('click', function() {
        currentSongIndex = parseInt(this.dataset.index);
        updateSongInfo();
        updatePlaylist();
        if (isPlaying) {
          playCurrentSong();
        }
      });
    });
  }
  
  // 获取网易云歌单数据
  async function fetchPlaylist() {
    try {
      console.log('正在获取歌单数据...');
      // 从配置文件中获取歌单 ID
      const playlistId = '2993057618';
      console.log('使用歌单 ID:', playlistId);
      
      const response = await fetch(`https://api.injahow.cn/meting/?type=playlist&id=${playlistId}`);
      const data = await response.json();
      
      console.log('歌单数据:', data);
      
      if (data && data.length > 0) {
        songs = data.map(song => ({
          title: song.name || song.title,
          artist: song.artist || song.ar?.[0]?.name || '未知艺术家',
          url: song.url,
          pic: song.pic
        }));
        
        updatePlaylist();
        updateSongInfo();
        songCount.textContent = `${songs.length}首`;
      }
    } catch (error) {
      console.error('获取歌单失败:', error);
      // 使用备用数据
      songs = [
        { title: "加载失败", artist: "请检查网络", url: "", pic: "" }
      ];
      updatePlaylist();
      updateSongInfo();
    }
  }
  
  // 切换音乐面板
  if (musicToggleBtn && musicPanel) {
    musicToggleBtn.addEventListener('click', function() {
      console.log('音乐按钮被点击');
      musicPanel.classList.toggle('active');
      if (songs.length === 0) {
        fetchPlaylist().then(() => {
          // 歌单加载完成后，如果有保存的状态，恢复播放
          const stateRestored = restorePlayerState();
          if (stateRestored && songs.length > 0) {
            updateSongInfo();
            updatePlaylist();
            if (isPlaying) {
              playCurrentSong();
            }
          }
        });
      }
      savePlayerState(); // 保存面板状态
    });
  }
  
  // 点击面板外部关闭
  document.addEventListener('click', function(e) {
    if (musicPanel && !musicPanel.contains(e.target) && !musicToggleBtn.contains(e.target)) {
      musicPanel.classList.remove('active');
    }
  });
  
  // 播放控制
  if (playBtn) {
    playBtn.addEventListener('click', function() {
      if (isPlaying) {
        pauseCurrentSong();
      } else {
        playCurrentSong();
      }
    });
  }
  
  if (prevBtn) {
    prevBtn.addEventListener('click', function() {
      playPrev();
    });
  }
  
  if (nextBtn) {
    nextBtn.addEventListener('click', function() {
      playNext();
    });
  }
  
  // 页面初始化时恢复状态
  document.addEventListener('DOMContentLoaded', function() {
    console.log('页面加载完成，初始化音乐播放器');
    
    // 尝试恢复保存的状态
    const stateRestored = restorePlayerState();
    
    // 如果有保存的状态，先加载歌单然后恢复播放
    if (stateRestored) {
      fetchPlaylist().then(() => {
        if (songs.length > 0) {
          updateSongInfo();
          updatePlaylist();
          if (isPlaying) {
            playCurrentSong();
          }
        }
      });
    }
    
    // 设置自动保存
    setupAutoSave();
  });
  
  function formatTime(seconds) {
    const minutes = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${minutes}:${secs.toString().padStart(2, '0')}`;
  }
</script>

<style>
  .mini-music-player {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 1000;
  }
  
  .music-toggle-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #4f46e5, #3730a3);
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 0.9rem;
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }
  
  .music-toggle-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);
  }
  
  .music-toggle-btn.playing {
    animation: musicPulse 2s infinite;
  }
  
  .music-panel {
    position: absolute;
    bottom: 60px;
    left: 0;
    width: 320px;
    max-height: 450px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 0.3s ease;
    overflow: hidden;
  }
  
  .music-panel.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  .custom-player {
    padding: 16px;
  }
  
  .player-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  
  .song-info {
    flex: 1;
    min-width: 0;
  }
  
  .song-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 2px;
  }
  
  .song-artist {
    font-size: 0.8rem;
    color: #666;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  .player-controls {
    display: flex;
    gap: 8px;
  }
  
  .control-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, #4f46e5, #3730a3);
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 0.8rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .control-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
  }
  
  .progress-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
    padding: 8px 0;
  }
  
  .progress-time {
    font-size: 0.7rem;
    color: #666;
    min-width: 30px;
    text-align: center;
  }
  
  .progress-track {
    flex: 1;
    height: 4px;
    background: #e9ecef;
    border-radius: 2px;
    overflow: hidden;
    position: relative;
  }
  
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4f46e5, #3730a3);
    border-radius: 2px;
    width: 0%;
    transition: width 0.3s ease;
  }
  
  .playlist-container {
    max-height: 200px;
    overflow-y: auto;
    background: #fff;
  }
  
  .playlist-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background: #f8f9fa;
    font-size: 0.8rem;
    font-weight: 600;
    color: #333;
    border-bottom: 1px solid #e9ecef;
  }
  
  .song-count {
    color: #666;
    font-size: 0.7rem;
  }
  
  .playlist-list {
    max-height: 180px;
    overflow-y: auto;
  }
  
  .playlist-item {
    padding: 8px 12px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .playlist-item:hover {
    background: #f8f9fa;
  }
  
  .playlist-item.active {
    background: linear-gradient(135deg, #4f46e5, #3730a3);
    color: #fff;
  }
  
  .playlist-item .song-name {
    font-size: 0.8rem;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  .playlist-item .song-artist {
    font-size: 0.7rem;
    opacity: 0.7;
    margin-top: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  .playlist-item.active .song-artist {
    opacity: 0.9;
  }
  
  @keyframes musicPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  
  @media (prefers-color-scheme: dark) {
    .music-panel {
      background: rgba(30, 30, 30, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .progress-bar {
      background: #2d2d2d;
      color: #ccc;
    }
    
    .playlist-header {
      background: #2d2d2d;
      color: #fff;
      border-bottom-color: #404040;
    }
    
    .playlist-item {
      border-bottom-color: #404040;
      color: #fff;
    }
    
    .playlist-item:hover {
      background: #3d3d3d;
    }
  }
  
  @media (max-width: 768px) {
    .mini-music-player {
      bottom: 16px;
      left: 16px;
    }
    
    .music-panel {
      width: 300px;
      max-height: 400px;
    }
    
    .music-toggle-btn {
      width: 36px;
      height: 36px;
      font-size: 0.8rem;
    }
  }
</style>


  

  <!-- 主脚本 -->
  
<script src="/js/main.js"></script>


  
  
    <script>
      (function() {
        var defaults = {
          tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            tags: 'ams',
            packages: {'[+]': ['noerrors']}
          },
          options: {
            skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            renderActions: {
              addMenu: []
            }
          }
        };
        var userCfg = {"tex":{"inlineMath":[["$","$"],["\\\\(","\\\\)"]],"displayMath":[["$$","$$"],["\\\\[","\\\\]"]],"tags":"ams"},"options":{"skipHtmlTags":["script","noscript","style","textarea","pre"],"ignoreHtmlClass":"tex2jax_ignore","processHtmlClass":"tex2jax_process"}};
        if (userCfg.tex) {
          userCfg.tex = Object.assign({}, defaults.tex, userCfg.tex);
        }
        if (userCfg.options) {
          userCfg.options = Object.assign({}, defaults.options, userCfg.options);
        }
        window.MathJax = Object.assign({}, defaults, userCfg);
      })();
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  
</body>
</html>
